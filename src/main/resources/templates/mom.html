<!DOCTYPE HTML>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta name="description" content="">
    <div th:replace="fragments/headerE::header-css"></div>
</head>
<body id="page-top">
    <!-- Page Wrapper -->
    <div id="wrapper">
        <div th:replace="fragments/headerE::sidebar"></div>    
        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">
            <!-- Main Content -->
            <div id="content">
                <div th:replace="fragments/headerE::topnav"></div>
                <!-- Begin Page Content -->
                <div class="container-fluid">
                    <button type="button" class="btn btn-sm btn-outline-primary btn-icon-split" data-toggle="modal" data-target="#modalInsert">
                        <span class="icon text-white-50">
                            <i class="fas fa-plus"></i>
                        </span>
                        <span class="text">Add MOM</span>
                    </button>
                    <br>
                    <br>
                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">MOM List</h6>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                                    <thead>
                                        <tr>
                                            <th>No</th> 
                                            <th hidden="">ID</th> 
                                            <th hidden="">Meeting ID</th> 
                                            <th>Meeting</th>
                                            <th hidden="">Meeting Desc</th>
                                            <th hidden="">Status Id</th>
                                            <th>Status</th>
                                            <th hidden="">Name PIC</th>
                                            <th hidden="">Last Name PIC</th>
                                            <th hidden="">Name Manager</th>
                                            <th hidden="">Email Manager</th>
                                            <th hidden="">Id Manager</th>
                                            <th hidden="">Date Meeting</th>
                                            <th hidden="">Time Meeting</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tfoot>
                                        <tr>
                                            <th>No</th> 
                                            <th hidden="">ID</th> 
                                            <th hidden="">Meeting ID</th> 
                                            <th>Meeting</th>
                                            <th hidden="">Meeting Desc</th>
                                            <th hidden="">Status Id</th>
                                            <th>Status</th>
                                            <th hidden="">Name PIC</th>
                                            <th hidden="">Last Name PIC</th>
                                            <th hidden="">Name Manager</th>
                                            <th hidden="">Email Manager</th>
                                            <th hidden="">Id Manager</th>
                                            <th hidden="">Date Meeting</th>
                                            <th hidden="">Time Meeting</th>
                                            <th>Action</th>
                                        </tr>
                                    </tfoot>
                                    <tbody>
                                        <tr th:each="mom,no : ${mom}">
                                            <td id="no" th:text="${no.count}"></td>
                                            <td hidden="" id="id" th:text="${mom.id}"></td>
                                            <td hidden="" id="meetingId" th:text="${mom.meeting.id}"></td>
                                            <td  id="meetingName" th:text="${mom.meeting.name}"></td>
                                            <td  hidden="" id="desc" th:text="${mom.meetingdesc}"></td>
                                            <td hidden="" id="statudId" th:text="${mom.status.id}"></td>
                                            <td id="statusName" th:text="${mom.status.name}"></td>
                                            <td hidden="" id="namePic" th:text="${mom.meeting.pic.name}"></td>
                                            <td hidden="" id="lastNamePic" th:text="${mom.meeting.pic.lastname}"></td>
                                            <td hidden="" id="nameManager" th:text="${mom.meeting.manager.name}"></td>
                                            <td hidden="" id="emailManager" th:text="${mom.meeting.manager.email}"></td>
                                            <td hidden="" id="idManager" th:text="${mom.meeting.manager.id}"></td>
                                            <td hidden="" id="dateMeeting" th:text="${mom.meeting.date}"></td>
                                            <td hidden="" id="timeMeeting" th:text="${mom.meeting.time}"></td>
                                            <td>
                                                <button data-target="#modalEdit" data-toggle="modal" type="button" class="btn btn-sm btn-outline-primary">
                                                    <span class="icon">
                                                        <i class="fas fa-edit"></i>
                                                    </span>
                                                </button>
                                                <button data-target="#modalFollowup" data-toggle="modal" type="button" id="btnFollowup" class="btn btn-sm btn-outline-primary">
                                                    <span class="icon">
                                                        <i class="fas fa-tasks"></i>
                                                    </span>
                                                </button>
                                                <button data-target="#modalSendEmail" data-toggle="modal" type="button" id="btnFollowup" class="btn btn-sm btn-outline-primary">
                                                    <span class="icon">
                                                        <i class="fas fa-paper-plane"></i>
                                                    </span>
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="modal fade" id="modalSendEmail" role="dialog">
                            <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h4 class="modal-title">Send Email</h4>
                                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                                    </div>
                                    <div class="modal-body">
                                        <form th:action="@{/pic/mom/sendmail}" method="POST" class="form-horizontal" role="form">
                                            <div class="form-group">
                                                <div class="col-sm-12">
                                                    <input type="text" id="modalMeetingName" name="meetingName" class="form-control" value="" readonly="" required="required">
                                                    <input type="text" id="modalPicName" name="picName" class="form-control" value="" readonly="" required="required">
                                                    <input type="text" id="modalPicLastName" name="picLastName" class="form-control" value="" readonly="" required="required">
                                                    <input type="text" id="modalManagerName" name="managerName" class="form-control" value="" readonly="" required="required">
                                                    <input type="text" id="modalManagerEmail" name="managerEmail" class="form-control" value="" readonly="" required="required">
                                                    <input type="text" id="modalMeetingDate" name="meetingDate" class="form-control" value="" readonly="" required="required">
                                                    <input type="text" id="modalMeetingTime" name="meetingTime" class="form-control" value="" readonly="" required="required">
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <div class="col-sm-12 col-sm-offset-2">
                                                    <button type="submit" class="btn btn-sm btn-outline-primary">Submit</button>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <!--Modal Insert-->
                        <div class="modal fade" id="modalInsert" role="dialog">
                            <div class="modal-dialog modal-dialog-centered" style="min-width: 65%;">
                                <div class="modal-content" style="min-height: 70vh;">
                                    <div class="modal-content">
                                        <!--Modal Header--> 
                                        <div class="modal-header">
                                            <h4 class="modal-title">Form MOM</h4>
                                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                                        </div>
                                        <!--Modal Body--> 
                                        <div class="modal-body">
                                            <form th:action="@{/pic/mom/save}" method="POST" class="form-horizontal" role="form">
                                                <div class="form-group">
                                                       <input type="hidden"  name="pic" th:value="${picId}" class="form-control" value="" required="required">
                                                       
                                                    
                                                    <label for="input" class="col-sm control-label">Meeting</label>
                                                    <div class="col-sm-12">
                                                        <select   name="meeting" class="form-control" id="" required="">
                                                            <option>None</option>
                                                            <option th:each="meeting : ${meeting}" th:if="${meeting.pic.id} == ${picId}" 
                                                                    th:value="${meeting.id}" 
                                                                    th:text="${meeting.name}" >
                                                           </option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label for="input" class="col-sm control-label">Meeting Description</label>
                                                    <div class="col-sm-12">
                                                        <textarea  id="modalDesc" name="desc" class="form-control" value="" rows="10" required="required"></textarea>
                                                    </div>
                                                </div>

                                                <div class="form-group">
                                                    <div class="col-sm-12 col-sm-offset-2">
                                                        <button type="submit" class="btn btn-sm btn-outline-primary">Submit</button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                        <!--Modal Footer--> 
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--End of Insert-->


                        <!--Modal Edit-->
                        <div class="modal fade" id="modalEdit" role="dialog">
                            <div class="modal-dialog modal-dialog-centered" style="min-width: 65%;">
                                <div class="modal-content" style="min-height: 70vh;">
                                    <div class="modal-content">
                                        <!--Modal Header--> 
                                        <div class="modal-header">
                                            <h4 class="modal-title">Form MOM Edit</h4>
                                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                                        </div>
                                        <!--Modal Body--> 
                                        <div class="modal-body">
                                            <form th:action="@{/pic/mom/edit}" method="POST" class="form-horizontal" role="form">
                                                <div class="form-group">
                                                    <label for="input" class="col-sm control-label">ID</label>
                                                    <div class="col-sm-12">
                                                        <input type="text" id="modalId" name="id" class="form-control" value="" readonly="" required="required">
                                                    </div>
                                                </div>
                                                <div class="col-sm-12">
                                                    <input type="hidden" id="modalMeetingId" name="meetingId" class="form-control" value="" readonly="" required="required">
                                                </div>
                                                <div class="col-sm-12">
                                                    <input type="hidden" id="modalStatusId" name="statusId" class="form-control" value="" readonly="" required="required">
                                                </div>
                                                <div class="form-group">
                                                    <label for="input" class="col-sm control-label">Meeting</label>
                                                    <div class="col-sm-12">
                                                        <input type="text" id="modalMeetingName" name="meetingName" class="form-control" value="" required="required">
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label for="input" class="col-sm control-label">Meeting Description</label>
                                                    <div class="col-sm-12">
                                                        <textarea  id="modalDesc" name="desc" class="form-control" value="" rows="7" required="required"></textarea>
                                                    </div>
                                                </div>

                                                <div class="form-group">
                                                    <div class="col-sm-12 col-sm-offset-2">
                                                        <button type="submit" class="btn btn-sm btn-outline-primary">Submit</button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                        <!--Modal Footer--> 
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--End of Modal Edit-->

                        <!-- Modal Add Followup-->
                        <div class="modal fade " id="modalFollowup" role="dialog">
                            <div class="modal-dialog modal-dialog-centered" style="min-width: 65%;">
                                <div class="modal-content" style="min-height: 70vh;">
                                    <!-- Modal Header -->
                                    <div class="modal-header">
                                        <h4 class="modal-title">Add Follow Up Meeting</h4>
                                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                                    </div>
                                    <!-- Modal Body -->
                                    <div class="modal-body">
                                        <form th:action="@{/pic/mom/savefollowup}" method="POST" class="form-horizontal" role="form">
                                            <div class="form-group">
                                                <div class="form-group">
                                                    <div class="col-sm-12">
                                                        <input type="hidden" id="modalMomId" name="momId" class="form-control" value="" readonly="" required="required">
                                                    </div>
                                                </div>
                                                <div>
                                                    <label for="input" class="col-sm control-label">Meeting</label>
                                                    <div class="col-sm-12">
                                                        <input type="text" id="modalMeeting" name="meeting" class="form-control" value="" required="required" readonly>
                                                        <br>
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label for="input" class="col-sm control-label">Follow Up Action</label>
                                                    <div class="col-sm-12">
                                                        <input type="text" id="" name="action" class="form-control" value="" required="required" >
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label for="input" class="col-sm control-label">Target Date</label>
                                                    <div class="col-sm-12">
                                                        <input type="date" name="targetdate" class="form-control" value="" required="required">
                                                    </div>
                                                </div>

                                                <div class="form-group">
                                                    <label for="input" class="col-sm control-label">PIC</label>
                                                    <div class="col-sm-12">
                                                        <select   name="pic" class="form-control" id="" required="">
                                                            <option>None</option>
                                                            <option th:each="employee : ${employee}" 
                                                                    th:value="${employee.id}" 
                                                                    th:text="${employee.name}" >
                                                            </option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label for="input" class="col-sm control-label">Notes</label>
                                                    <div class="col-sm-12">
                                                        <textarea id="modalNote" name="note" class="form-control" rows="3"></textarea>
                                                    </div>
                                                </div>

                                                <div class="form-group">
                                                    <div class="col-sm-12 col-sm-offset-2">
                                                        <button type="submit" class="btn btn-sm btn-outline-primary">Submit</button>
                                                    </div>
                                                </div>

                                        </form>

                                        <div align="center">
                                            <table  class="table table-striped table-bordered" style="width: 100%" id="roleTable">
                                                <thead>
                                                    <tr>
                                                        <th>No</th>
                                                        <th>Follow Up</th>
                                                        <th>Target Date</th>
                                                        <th>Notes</th>
                                                        <th>PIC</th>
                                                        <th hidden="">MOM</th>
                                                        <th>Action</th>
                                                    </tr>
                                                </thead>
                                                <tbody>

                                                    <tr th:each=" followup,no : ${followup}" >
                                                        <td th:text="${no.count}"></td>
                                                        <td id="name" th:text="${followup.name}"></td>
                                                        <td id="attendees" th:text="${followup.targetdate}"></td>
                                                        <td id="fd" th:text="${followup.notes}"></td>
                                                        <td id="fdd" th:text="${followup.pic.name}"></td>
                                                        <td hidden="" th:text="${followup.mom.id}"></td>

                                                        <td>
                                                            <a th:href="@{'/pic/followup/delete/' + ${followup.id}}" class="btn btn-sm btn-outline-danger">
                                                                <span class="icon">
                                                                    <i class="fas fa-trash"></i>
                                                                </span>
                                                            </a>
                                                        </td>
                                                    </tr>

                                                </tbody>
                                            </table>
                                        </div>

                                    </div>
                                    <!-- Modal Footer -->
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--End of Modal Attendees-->




                </div>
            </div>
            <!-- /.container-fluid -->  
        </div>
        <!-- End of Main Content -->
        <div th:replace="fragments/headerE::footer"></div>
    </div>
    <!-- End of Content Wrapper -->
</div>
<!-- End of Page Wrapper -->
<div th:replace="fragments/footer::footer"></div>
<script>
    $('#modalEdit').on('show.bs.modal', function (e) {
        var _button = $(e.relatedTarget);
        var _row = _button.parents("tr");

        var _id = _row.find("#id").text();
        var _meetingName = _row.find("#meetingName").text();
        var _meetingId = _row.find("#meetingId").text();
        var _desc = _row.find("#desc").text();
        var _statusId = _row.find("#statusId").text();
        //                    alert(_id);
        $(this).find('#modalId').val(_id);
        $(this).find('#modalMeetingName').val(_meetingName);
        $(this).find('#modalMeetingId').val(_meetingId);
        $(this).find('#modalDesc').val(_desc);
        $(this).find('#modalStatusId').val(_statusId);
    });
</script>
<!--<script>
    $('#modalInsert').on('show.bs.modal', function (e) {
        var _button = $(e.relatedTarget);
        var _row = _button.parents("tr");

        var _id = _row.find("idManager").text();

        //                    alert(_id);
        $(this).find('#modalIdManager').val(_id);
    });
</script>-->
<script>
    $('#modalFollowup').on('show.bs.modal', function (e) {
        var _button = $(e.relatedTarget);
        var _row = _button.parents("tr");

        var _id = _row.find("#id").text();
        var _meeting = _row.find("#meetingName").text();

        //                    alert(_id);
        $(this).find('#modalMomId').val(_id);
        $(this).find('#modalMeeting').val(_meeting);
    });
</script>

<script>
    $('#modalSendEmail').on('show.bs.modal', function (e) {
        var _button = $(e.relatedTarget);
        var _row = _button.parents("tr");

        var _meetingName = _row.find("#meetingName").text();
        var _picName = _row.find("#namePic").text();
        var _picLastName = _row.find("#lastNamePic").text();
        var _managerName = _row.find("#nameManager").text();
        var _managerEmail = _row.find("#emailManager").text();
        var _meetingDate = _row.find("#dateMeeting").text();
        var _meetingTime = _row.find("#timeMeeting").text();

        //                    alert(_id);
        $(this).find('#modalMeetingName').val(_meetingName);
        $(this).find('#modalPicName').val(_picName);
        $(this).find('#modalPicLastName').val(_picLastName);
        $(this).find('#modalManagerName').val(_managerName);
        $(this).find('#modalManagerEmail').val(_managerEmail);
        $(this).find('#modalMeetingDate').val(_meetingDate);
        $(this).find('#modalMeetingTime').val(_meetingTime);
    });
</script>
</body>
</html>
